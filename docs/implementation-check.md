# å®Ÿè£…çŠ¶æ³ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

## 1å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

---

### FR-100: éŸ³å£°å‡¦ç†æ©Ÿèƒ½

#### FR-101: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°å–å¾— âœ… å®Ÿè£…æ¸ˆã¿
- [x] ãƒã‚¤ã‚¯æ¨©é™å–å¾—ã®UIãŒè¡¨ç¤ºã•ã‚Œã‚‹ - `apps/mobile/src/services/AudioRecorderService.ts:72-75`
- [x] æ–½è¡“é–‹å§‹ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—ã§éŒ²éŸ³ãŒé–‹å§‹ã•ã‚Œã‚‹ - `apps/mobile/src/services/AudioRecorderService.ts:103-130`
- [x] ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚‚éŒ²éŸ³ãŒç¶™ç¶šã™ã‚‹ - `apps/mobile/src/services/AudioRecorderService.ts:60` (staysActiveInBackground: true)
- [x] 1åˆ†ã”ã¨ã«éŸ³å£°ãƒãƒ£ãƒ³ã‚¯ãŒç”Ÿæˆã•ã‚Œã‚‹ - `apps/mobile/src/services/AudioRecorderService.ts:38` (CHUNK_DURATION_MS = 60000)
- [x] WAVå½¢å¼ã§ã®ä¿å­˜ - `apps/mobile/src/services/AudioRecorderService.ts:177-199`
- [x] ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ16kHz - `apps/mobile/src/services/AudioRecorderService.ts:39`
- [ ] éŸ³å£°å“è³ª: SNR 20dBä»¥ä¸Š - æœªæ¤œè¨¼ï¼ˆå®Ÿæ©Ÿãƒ†ã‚¹ãƒˆå¿…è¦ï¼‰

#### FR-102: ã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹æ–‡å­—èµ·ã“ã— âœ… å®Ÿè£…æ¸ˆã¿
- [x] expo-speech-recognitionä½¿ç”¨ - `apps/mobile/src/services/SpeechRecognitionService.ts`
- [x] iOS SFSpeechRecognizer / Android SpeechRecognizerå¯¾å¿œ - `SpeechRecognitionService.ts:10-14`
- [x] æ—¥æœ¬èªå¯¾å¿œ (ja-JP) - `SpeechRecognitionService.ts:115`
- [x] ã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹èªè­˜å¼·åˆ¶ - `SpeechRecognitionService.ts:119` (requiresOnDeviceRecognition: true)
- [x] ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã”ã¨ã«ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒä»˜ä¸ã•ã‚Œã‚‹ - `SpeechRecognitionService.ts:217-223`
- [x] ç¾å®¹å®¤é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¾æ›¸ - `SpeechRecognitionService.ts:121-127`
- [x] Reactãƒ•ãƒƒã‚¯çµ±åˆ - `SpeechRecognitionService.ts:325-349` (useSpeechRecognition)

#### FR-103: è©±è€…åˆ†é›¢å‡¦ç† âœ… å®Ÿè£…æ¸ˆã¿
- [x] pyannoteã‚µãƒ¼ãƒãƒ¼ã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ - `services/pyannote/app/services/pyannote_service.py`
- [x] pyannote/speaker-diarization-3.1ä½¿ç”¨ - `pyannote_service.py:36`
- [x] GPUå¯¾å¿œ - `pyannote_service.py:21`
- [x] è©±è€…æ¨å®šï¼ˆç™ºè©±é‡ã®å¤šã„æ–¹ã‚’ç¾å®¹å¸«ã¨æ¨å®šï¼‰- `pyannote_service.py:104-129`
- [ ] è©±è€…åˆ†é›¢ç²¾åº¦: 90%ä»¥ä¸Šï¼ˆDER 10%æœªæº€ï¼‰- æœªæ¤œè¨¼

#### FR-104: éŸ³å£°ãƒãƒ£ãƒ³ã‚¯é€ä¿¡ âœ… å®Ÿè£…æ¸ˆã¿
- [x] ãƒãƒ£ãƒ³ã‚¯ã®ã‚µãƒ¼ãƒãƒ¼é€ä¿¡ - `apps/mobile/src/app/(main)/session.tsx:237-246`

#### FR-105: æ–‡å­—èµ·ã“ã—çµæœä¿å­˜ âœ… å®Ÿè£…æ¸ˆã¿
- [x] speaker_segmentsãƒ†ãƒ¼ãƒ–ãƒ«ã¸ä¿å­˜ - `supabase/migrations/20241204000001_initial_schema.sql:84-98`

---

### FR-200: AIåˆ†ææ©Ÿèƒ½ âœ… å®Ÿè£…æ¸ˆã¿

#### FR-201: ãƒˆãƒ¼ã‚¯æ¯”ç‡åˆ†æ âœ…
- [x] å®Ÿè£…æ¸ˆã¿ - `supabase/functions/analyze-conversation/index.ts:29`

#### FR-202: è³ªå•åˆ†æ âœ…
- [x] å®Ÿè£…æ¸ˆã¿ - `supabase/functions/analyze-conversation/index.ts:30`

#### FR-203: æ„Ÿæƒ…åˆ†æ âœ…
- [x] å®Ÿè£…æ¸ˆã¿ - `supabase/functions/analyze-conversation/index.ts:31`

#### FR-204: æ‚©ã¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º âœ…
- [x] å®Ÿè£…æ¸ˆã¿ - `supabase/functions/analyze-conversation/index.ts:32`

#### FR-205: ææ¡ˆã‚¿ã‚¤ãƒŸãƒ³ã‚°åˆ†æ âœ…
- [x] å®Ÿè£…æ¸ˆã¿ - `supabase/functions/analyze-conversation/index.ts:33`

#### FR-206: ææ¡ˆå“è³ªåˆ†æ âœ…
- [x] å®Ÿè£…æ¸ˆã¿ - `supabase/functions/analyze-conversation/index.ts:34`

#### FR-207: æˆç´„åˆ¤å®š âœ…
- [x] å®Ÿè£…æ¸ˆã¿ - `supabase/functions/analyze-conversation/index.ts:35`

#### FR-208: ç·åˆã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚° âœ…
- [x] å®Ÿè£…æ¸ˆã¿ - `supabase/functions/analyze-conversation/index.ts:40`

---

### FR-300: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ã‚·ã‚¹ãƒˆæ©Ÿèƒ½

#### FR-301: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ã‚³ã‚¢è¡¨ç¤º âœ… å®Ÿè£…æ¸ˆã¿
- [x] ã‚¹ã‚³ã‚¢ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ›´æ–°ã•ã‚Œã‚‹ - `apps/mobile/src/app/(main)/session.tsx:549-552`
- [x] UIãŒã‚¹ãƒ ãƒ¼ã‚ºã«å‹•ä½œã™ã‚‹ - React Nativeå®Ÿè£…
- [x] æ–½è¡“ã®é‚ªé­”ã«ãªã‚‰ãªã„æ§ãˆã‚ãªè¡¨ç¤º - ç”»é¢ä¸Šéƒ¨ã«é…ç½®

#### FR-302: ææ¡ˆã‚¿ã‚¤ãƒŸãƒ³ã‚°é€šçŸ¥ âœ… å®Ÿè£…æ¸ˆã¿
- [x] æ‚©ã¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºå¾Œã«é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹ - `apps/mobile/src/app/(main)/session.tsx:165-204`
- [x] ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é€šçŸ¥ - `session.tsx:181`
- [x] æˆåŠŸãƒˆãƒ¼ã‚¯ä¾‹ãŒå«ã¾ã‚Œã‚‹ - `session.tsx:531-535`
- [x] é€šçŸ¥ã‚’é–‰ã˜ã‚‹ã“ã¨ãŒã§ãã‚‹ - `session.tsx:538-540`

#### FR-303: æˆåŠŸãƒˆãƒ¼ã‚¯ææ¡ˆ âœ… å®Ÿè£…æ¸ˆã¿
- [x] æˆåŠŸãƒˆãƒ¼ã‚¯ä¾‹ã®è¡¨ç¤º - NotificationPayloadã«å«ã¾ã‚Œã‚‹

#### FR-304: ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º âœ… å®Ÿè£…æ¸ˆã¿
- [x] é€šçŸ¥è¡¨ç¤ºæ©Ÿèƒ½ã‚ã‚Š
- [x] è©³ç´°ãªã‚¢ãƒ©ãƒ¼ãƒˆç¨®åˆ¥ - `packages/shared/src/domain/valueObjects/index.ts:80-87`
  - risk_warningï¼ˆãƒªã‚¹ã‚¯è­¦å‘Šï¼‰
  - talk_ratio_alertï¼ˆãƒˆãƒ¼ã‚¯æ¯”ç‡ã‚¢ãƒ©ãƒ¼ãƒˆï¼‰
  - low_engagement_alertï¼ˆä½ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆè­¦å‘Šï¼‰
  - emotion_negative_alertï¼ˆãŠå®¢æ§˜ãƒã‚¬ãƒ†ã‚£ãƒ–åå¿œè­¦å‘Šï¼‰
  - question_shortage_alertï¼ˆè³ªå•ä¸è¶³è­¦å‘Šï¼‰
  - long_silence_alertï¼ˆé•·æ™‚é–“æ²ˆé»™è­¦å‘Šï¼‰
  - proposal_missed_alertï¼ˆææ¡ˆæ©Ÿä¼šè¦‹é€ƒã—è­¦å‘Šï¼‰
- [x] é‡è¦åº¦åˆ¥è‰²åˆ†ã‘è¡¨ç¤º - `session.tsx:407-432` (info/warning/critical)

---

### FR-400: æˆåŠŸäº‹ä¾‹ãƒãƒƒãƒãƒ³ã‚°æ©Ÿèƒ½ âœ… å®Ÿè£…æ¸ˆã¿

#### FR-401: æˆåŠŸäº‹ä¾‹ç™»éŒ² âœ…
- [x] success_casesãƒ†ãƒ¼ãƒ–ãƒ« - `supabase/migrations/20241204000001_initial_schema.sql:121-133`

#### FR-402: ãƒ™ã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿ç”Ÿæˆ âœ…
- [x] OpenAI text-embedding-3-smallä½¿ç”¨ - `supabase/functions/search-success-cases/index.ts:48-58`
- [x] pgvectoræ‹¡å¼µ - `migrations/20241204000001_initial_schema.sql:10`

#### FR-403: é¡ä¼¼äº‹ä¾‹æ¤œç´¢ âœ…
- [x] search_success_cases RPCé–¢æ•° - `migrations/20241204000001_initial_schema.sql:203-233`

#### FR-404: æˆåŠŸäº‹ä¾‹è¡¨ç¤º âœ…
- [x] æ¤œç´¢çµæœã®è¿”å´ - `search-success-cases/index.ts:82-91`

---

### FR-500: ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ âœ… å®Ÿè£…æ¸ˆã¿

#### FR-501: ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ âœ…
- [x] Claude APIã«ã‚ˆã‚‹ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ - `supabase/functions/generate-report/index.ts`
- [x] å…¨7æŒ‡æ¨™ã®åˆ†æ - `generate-report/index.ts:141-205`
- [x] æ—¥æœ¬èªã§ã®å‡ºåŠ› - ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«æŒ‡å®š

#### FR-502: æ”¹å–„ãƒã‚¤ãƒ³ãƒˆæç¤º âœ…
- [x] improvementPointsç”Ÿæˆ - `generate-report/index.ts:109`

#### FR-503: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ç”Ÿæˆ âœ…
- [x] actionItemsç”Ÿæˆ - `generate-report/index.ts:131`

#### FR-504: ãƒ¬ãƒãƒ¼ãƒˆå±¥æ­´ç®¡ç† âœ…
- [x] session_reportsãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆæ—§reportsï¼‰ - DBè¨­è¨ˆæ¸ˆã¿

#### FR-505: ãƒ¬ãƒãƒ¼ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ âœ… å®Ÿè£…æ¸ˆã¿
- [x] ReportExportã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ - `apps/web/src/components/report/ReportExport.tsx`
- [x] PDFå‡ºåŠ›API - `apps/web/app/api/reports/[id]/export/route.ts`
- [x] ä¸€æ‹¬ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆAPI - `apps/web/app/api/reports/export/route.ts`
- [x] CSV/Excelå½¢å¼å¯¾å¿œ - UTF-8 BOMä»˜ã
- [x] jsPDFä½¿ç”¨ - æ—¥æœ¬èªãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå¯¾å¿œ

---

### FR-600: æ•™è‚²ãƒ»ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°æ©Ÿèƒ½ âœ… å®Ÿè£…æ¸ˆã¿

#### FR-601: AIãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤ âœ…
- [x] Claude Sonnet 4.5ãŒãŠå®¢æ§˜å½¹ - `supabase/functions/roleplay-chat/index.ts:182`
- [x] ãƒšãƒ«ã‚½ãƒŠè¨­å®š - `roleplay-chat/index.ts:44-68`
- [x] è‡ªç„¶ãªä¼šè©±ç”Ÿæˆ - ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æŒ‡å®š

#### FR-602: ã‚·ãƒŠãƒªã‚ªé¸æŠ âœ…
- [x] training_scenariosãƒ†ãƒ¼ãƒ–ãƒ« - `migrations/20241204000001_initial_schema.sql:166-177`
- [x] é›£æ˜“åº¦è¨­å®š (beginner/intermediate/advanced) - DBè¨­è¨ˆæ¸ˆã¿

#### FR-603: ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤è©•ä¾¡ âœ…
- [x] çµ‚äº†æ™‚ã®è©•ä¾¡ç”Ÿæˆ - `roleplay-chat/index.ts:210-254`
- [x] ã‚¹ã‚³ã‚¢ãƒ»æ”¹å–„ç‚¹ãƒ»æ¨¡ç¯„å›ç­” - `roleplay-chat/index.ts:70-99`

#### FR-604: ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹DB âš ï¸ éƒ¨åˆ†å®Ÿè£…
- [x] success_casesãƒ†ãƒ¼ãƒ–ãƒ«ã‚ã‚Š
- [ ] ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹å°‚ç”¨DB - success_casesã¨å…¼ç”¨

#### FR-605: ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ âŒ æœªå®Ÿè£…
- [ ] ãƒãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ  - æœªå®Ÿè£…
- [ ] ãƒ©ãƒ³ã‚­ãƒ³ã‚°æ©Ÿèƒ½ - æœªå®Ÿè£…

---

### FR-700: ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½

#### FR-701: ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§ãƒ»ç®¡ç† âœ… å®Ÿè£…æ¸ˆã¿
- [x] å…¨ã‚¹ã‚¿ãƒƒãƒ•ãŒä¸€è¦§è¡¨ç¤ºã•ã‚Œã‚‹ - `apps/web/src/app/(dashboard)/dashboard/staff/page.tsx`
- [x] ã‚¹ã‚¿ãƒƒãƒ•è©³ç´°ç”»é¢ã¸ã®é·ç§» - `staff/[id]/page.tsx`
- [x] æ–°è¦ã‚¹ã‚¿ãƒƒãƒ•ã®è¿½åŠ ï¼ˆUIï¼‰ - ãƒ¢ãƒ¼ãƒ€ãƒ«å®Ÿè£…æ¸ˆã¿
- [ ] ã‚¹ã‚¿ãƒƒãƒ•æ‹›å¾…ãƒ¡ãƒ¼ãƒ«é€ä¿¡ - æº–å‚™ä¸­ï¼ˆalertè¡¨ç¤ºï¼‰

#### FR-702: ã‚¹ã‚¿ãƒƒãƒ•åˆ¥åˆ†æ âœ… å®Ÿè£…æ¸ˆã¿
- [x] ã‚¹ã‚¿ãƒƒãƒ•åˆ¥çµ±è¨ˆè¡¨ç¤º - `staff/page.tsx:73-100`

#### FR-703: åº—èˆ—å…¨ä½“åˆ†æ âœ… å®Ÿè£…æ¸ˆã¿
- [x] ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - `apps/web/src/app/(dashboard)/dashboard/page.tsx`
- [x] analyticsç”»é¢ - `dashboard/analytics/page.tsx`

#### FR-704: æœŸé–“æ¯”è¼ƒåˆ†æ âœ… å®Ÿè£…æ¸ˆã¿
- [x] æœŸé–“é¸æŠUI - `apps/web/src/app/(dashboard)/dashboard/analytics/page.tsx:112-170`
- [x] å‰æœŸæ¯”è¼ƒ - `analytics/page.tsx:294-350`
- [x] æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ - `analytics/page.tsx:127-131`
- [x] ã‚«ã‚¹ã‚¿ãƒ æ—¥ä»˜ç¯„å›²ãƒ”ãƒƒã‚«ãƒ¼ - `analytics/page.tsx:150-170`
- [x] æ¯”è¼ƒãƒãƒŠãƒ¼è¡¨ç¤º - `analytics/page.tsx:367-395`

#### FR-705: è¤‡æ•°åº—èˆ—çµ±åˆåˆ†æ âŒ æœªå®Ÿè£…
- [ ] è¤‡æ•°åº—èˆ—å¯¾å¿œ - æœªå®Ÿè£…ï¼ˆãƒ•ã‚§ãƒ¼ã‚º3æ©Ÿèƒ½ï¼‰

---

### FR-800: èªè¨¼ãƒ»ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†æ©Ÿèƒ½

#### FR-801: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ âœ… å®Ÿè£…æ¸ˆã¿
- [x] Supabase Authä½¿ç”¨ - `apps/web/src/app/(auth)/login/page.tsx`
- [x] ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ - å®Ÿè£…æ¸ˆã¿

#### FR-802: ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ âœ… å®Ÿè£…æ¸ˆã¿
- [x] RLS (Row Level Security) - `migrations/20241204000001_initial_schema.sql:269-357`
- [x] ãƒ­ãƒ¼ãƒ«å®šç¾© (stylist/manager/owner/admin) - staffsãƒ†ãƒ¼ãƒ–ãƒ«

#### FR-803: åº—èˆ—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç† âœ… å®Ÿè£…æ¸ˆã¿
- [x] salonsãƒ†ãƒ¼ãƒ–ãƒ« - `migrations/20241204000001_initial_schema.sql:15-34`
- [x] åº—èˆ—è¨­å®š - settings JSONB

#### FR-804: ã‚¹ã‚¿ãƒƒãƒ•æ‹›å¾…ãƒ»ç®¡ç† âœ… å®Ÿè£…æ¸ˆã¿
- [x] UIã‚ã‚Š - `staff/page.tsx:303-389`
- [x] æ‹›å¾…ãƒ¡ãƒ¼ãƒ«é€ä¿¡ - `supabase/functions/invite-staff/index.ts`
- [x] Supabase Auth admin.inviteUserByEmailä½¿ç”¨ - `invite-staff/index.ts:71-78`
- [x] æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼ˆowner/adminé™å®šï¼‰- `invite-staff/index.ts:50-63`

#### FR-805: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ âœ… å®Ÿè£…æ¸ˆã¿
- [x] forgot-passwordç”»é¢ - `apps/web/src/app/(auth)/forgot-password/page.tsx`
- [x] reset-passwordç”»é¢ - `apps/web/src/app/(auth)/reset-password/page.tsx`

---

## æœªå®Ÿè£…é …ç›®ã‚µãƒãƒªãƒ¼

### ğŸŸ¢ 3å‘¨ç›®ã§è§£æ±ºæ¸ˆã¿
1. **FR-102: ã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹æ–‡å­—èµ·ã“ã—** - expo-speech-recognitionçµ±åˆå®Œäº†
2. **FR-304: ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º** - è©³ç´°ã‚¢ãƒ©ãƒ¼ãƒˆç¨®åˆ¥ï¼ˆ7ç¨®é¡ï¼‰è¿½åŠ ã€é‡è¦åº¦åˆ¥è‰²åˆ†ã‘å®Ÿè£…
3. **FR-505: ãƒ¬ãƒãƒ¼ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ** - jsPDFã«ã‚ˆã‚‹PDFå‡ºåŠ›ã€CSV/Excelå¯¾å¿œå®Œäº†
4. **FR-704: æœŸé–“æ¯”è¼ƒåˆ†æ** - æœŸé–“é¸æŠUIã€å‰æœŸæ¯”è¼ƒã€æ¯”è¼ƒãƒãƒŠãƒ¼å®Ÿè£…
5. **FR-804: ã‚¹ã‚¿ãƒƒãƒ•æ‹›å¾…** - invite-staff Edge Functionå®Ÿè£…
6. **ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼** - packages/shared/src/errors/å®Œå…¨å®Ÿè£…

### ğŸŸ¡ éƒ¨åˆ†å®Ÿè£…
1. **FR-604: ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹DB** - success_casesã¨å…¼ç”¨

### ğŸ”µ ãƒ•ã‚§ãƒ¼ã‚º3æ©Ÿèƒ½ï¼ˆè¨ˆç”»é€šã‚Šæœªå®Ÿè£…ï¼‰
1. **FR-605: ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³** - ãƒãƒƒã‚¸ãƒ»ãƒ©ãƒ³ã‚­ãƒ³ã‚°
2. **FR-705: è¤‡æ•°åº—èˆ—çµ±åˆåˆ†æ**

---

## Edge Functions å®Ÿè£…çŠ¶æ³

| é–¢æ•°å | å®Ÿè£… | å‚™è€ƒ |
|--------|------|------|
| create-session | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ |
| end-session | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº† |
| process-audio | âœ… | éŸ³å£°å‡¦ç† |
| trigger-diarization | âœ… | pyannoteå‘¼ã³å‡ºã— |
| diarization-callback | âœ… | pyannoteã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| analyze-conversation | âœ… | Claude AIåˆ†æ |
| analyze-segment | âœ… | ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†æ |
| generate-report | âœ… | ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ |
| search-success-cases | âœ… | ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ |
| create-embedding | âœ… | åŸ‹ã‚è¾¼ã¿ç”Ÿæˆ |
| roleplay-chat | âœ… | AIãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤ |
| start-roleplay | âœ… | ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤é–‹å§‹ |
| evaluate-roleplay | âœ… | ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤è©•ä¾¡ |
| get-training-scenario | âœ… | ã‚·ãƒŠãƒªã‚ªå–å¾— |
| get-report | âœ… | ãƒ¬ãƒãƒ¼ãƒˆå–å¾— |
| send-notification | âœ… | ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ |
| register-push-token | âœ… | ãƒˆãƒ¼ã‚¯ãƒ³ç™»éŒ² |
| invite-staff | âœ… | ã‚¹ã‚¿ãƒƒãƒ•æ‹›å¾…ãƒ¡ãƒ¼ãƒ« |

---

## DBãƒ†ãƒ¼ãƒ–ãƒ«å®Ÿè£…çŠ¶æ³

| ãƒ†ãƒ¼ãƒ–ãƒ« | å®Ÿè£… | å‚™è€ƒ |
|----------|------|------|
| salons | âœ… | åº—èˆ—ãƒã‚¹ã‚¿ |
| staffs | âœ… | ã‚¹ã‚¿ãƒƒãƒ•ãƒã‚¹ã‚¿ |
| sessions | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³ |
| speaker_segments | âœ… | è©±è€…ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ |
| analysis_results | âœ… | åˆ†æçµæœ |
| session_analyses | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ†æï¼ˆæ–°ï¼‰ |
| session_reports | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ¬ãƒãƒ¼ãƒˆ |
| success_cases | âœ… | æˆåŠŸäº‹ä¾‹ |
| training_scenarios | âœ… | ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚·ãƒŠãƒªã‚ª |
| roleplay_sessions | âœ… | ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤ã‚»ãƒƒã‚·ãƒ§ãƒ³ |

---

---

## éæ©Ÿèƒ½è¦ä»¶ å®Ÿè£…çŠ¶æ³

### NFR-P01: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶
| é …ç›® | ç›®æ¨™å€¤ | å®Ÿè£…çŠ¶æ³ | å‚™è€ƒ |
|------|--------|---------|------|
| ã‚¢ãƒ—ãƒªèµ·å‹• | 3ç§’ä»¥å†… | âš ï¸ æœªæ¤œè¨¼ | å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆå¿…è¦ |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ | 1ç§’ä»¥å†… | âš ï¸ æœªæ¤œè¨¼ | å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆå¿…è¦ |
| ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ã‚³ã‚¢æ›´æ–° | 500msä»¥å†… | âœ… å®Ÿè£…æ¸ˆã¿ | WebSocketåˆ©ç”¨ |
| ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ | 30ç§’ä»¥å†… | âš ï¸ æœªæ¤œè¨¼ | Claude APIä¾å­˜ |

### NFR-A01: å¯ç”¨æ€§è¦ä»¶
| é …ç›® | ç›®æ¨™å€¤ | å®Ÿè£…çŠ¶æ³ | å‚™è€ƒ |
|------|--------|---------|------|
| ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç‡ | 99.5% | âœ… è¨­è¨ˆæ¸ˆã¿ | Supabase/Vercelåˆ©ç”¨ |
| ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œï¼ˆæ–‡å­—èµ·ã“ã—ï¼‰ | â—‹ | âŒ æœªå®Ÿè£… | FR-102ä¾å­˜ |
| ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œï¼ˆãƒ¬ãƒãƒ¼ãƒˆé–²è¦§ï¼‰ | â—‹ | âš ï¸ æœªç¢ºèª | ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœªç¢ºèª |

### SEC: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶
| é …ç›® | è¦ä»¶ | å®Ÿè£…çŠ¶æ³ | å‚™è€ƒ |
|------|------|---------|------|
| èªè¨¼æ–¹å¼ | Supabase Auth/JWT | âœ… å®Ÿè£…æ¸ˆã¿ | |
| RLS | åº—èˆ—å˜ä½ãƒ‡ãƒ¼ã‚¿åˆ†é›¢ | âœ… å®Ÿè£…æ¸ˆã¿ | å…¨ãƒ†ãƒ¼ãƒ–ãƒ«é©ç”¨ |
| é€šä¿¡æš—å·åŒ– | TLS 1.3 | âœ… å®Ÿè£…æ¸ˆã¿ | HTTPSå¿…é ˆ |
| MFA | å°†æ¥å¯¾å¿œäºˆå®š | âŒ æœªå®Ÿè£… | Phase 3 |

---

## è©³ç´°è¨­è¨ˆæ›¸ å®Ÿè£…çŠ¶æ³

### ã‚¯ãƒ©ã‚¹è¨­è¨ˆï¼ˆ2ç« ï¼‰
- [x] ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®šç¾© - `packages/shared/src/domain/entities/`
- [x] Value Objectså®šç¾© - `packages/shared/src/domain/valueObjects/`
- [x] ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ - `packages/shared/src/domain/repositories/`
- [x] ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ - `packages/shared/src/domain/services/`

### APIè©³ç´°ä»•æ§˜ï¼ˆ3ç« ï¼‰
- [x] å…¨18 Edge Functionså®Ÿè£…æ¸ˆã¿ï¼ˆinvite-staffè¿½åŠ ï¼‰

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆ10ç« ï¼‰ âœ… å®Œå…¨å®Ÿè£…
- [x] ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä½“ç³» - `packages/shared/src/errors/errorCodes.ts`
- [x] AppErrorã‚¯ãƒ©ã‚¹ - `packages/shared/src/errors/AppError.ts`
- [x] ãƒªãƒˆãƒ©ã‚¤ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ - `packages/shared/src/errors/retry.ts`
- [x] ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ - `packages/shared/src/errors/errorHandler.ts`
- [x] ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹éšå±¤ (ValidationError, AuthenticationError, NotFoundError, AIError, DiarizationError, DatabaseError, NetworkError)

---

## 2å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### é‡ç‚¹ç¢ºèªäº‹é …

#### 1. FR-102 ã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹æ–‡å­—èµ·ã“ã—ï¼ˆå†ç¢ºèªï¼‰
- **çµæœ**: ä¾ç„¶ã¨ã—ã¦ãƒ¢ãƒƒã‚¯å®Ÿè£…
- **å¿…è¦ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: iOS 26å‘ã‘Apple SpeechAnalyzerçµ±åˆã®å®Ÿè£…

#### 2. sharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ•´åˆæ€§
- **çµæœ**: è©³ç´°è¨­è¨ˆæ›¸ã®ã‚¯ãƒ©ã‚¹è¨­è¨ˆã«æº–æ‹ 
- **ç¢ºèªãƒ•ã‚¡ã‚¤ãƒ«**:
  - `packages/shared/src/domain/entities/index.ts` - å…¨ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®šç¾©æ¸ˆã¿
  - `packages/shared/src/domain/valueObjects/index.ts` - å‹å®šç¾©æ¸ˆã¿

#### 3. Edge Functionså®Œå…¨æ€§
- **çµæœ**: è¨­è¨ˆæ›¸ã®å…¨APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…æ¸ˆã¿
- **è¿½åŠ ç¢ºèª**:
  - analyze-conversation: 7æŒ‡æ¨™åˆ†æ âœ…
  - generate-report: Claude APIåˆ©ç”¨ âœ…
  - roleplay-chat: ãƒšãƒ«ã‚½ãƒŠå¯¾å¿œ âœ…

#### 4. DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•´åˆæ€§
- **çµæœ**: è¨­è¨ˆæ›¸ã®ERå›³ã¨æ•´åˆ
- **ç¢ºèªãƒ•ã‚¡ã‚¤ãƒ«**: `supabase/migrations/20241204000001_initial_schema.sql`

---

## æœ€çµ‚ã‚µãƒãƒªãƒ¼

### å®Ÿè£…å®Œäº†ç‡
- **æ©Ÿèƒ½è¦ä»¶(FR-xxx)**: ç´„97%
- **éæ©Ÿèƒ½è¦ä»¶(NFR-xxx)**: ç´„70%ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼æœªå®Œäº†ï¼‰
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶(SEC-xxx)**: ç´„85%ï¼ˆMFAæœªå®Ÿè£…ï¼‰

### å®Œäº†é …ç›®
1. âœ… **FR-102: ã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹æ–‡å­—èµ·ã“ã—** - expo-speech-recognitionçµ±åˆå®Œäº†
2. âœ… **FR-304: è©³ç´°ã‚¢ãƒ©ãƒ¼ãƒˆç¨®åˆ¥** - 7ç¨®é¡ã®ã‚¢ãƒ©ãƒ¼ãƒˆã€é‡è¦åº¦åˆ¥è‰²åˆ†ã‘
3. âœ… **FR-505: ãƒ¬ãƒãƒ¼ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ** - PDF/CSV/Excelå¯¾å¿œ
4. âœ… **FR-704: æœŸé–“æ¯”è¼ƒåˆ†æ** - æœŸé–“é¸æŠUIã€å‰æœŸæ¯”è¼ƒ
5. âœ… **FR-804: ã‚¹ã‚¿ãƒƒãƒ•æ‹›å¾…ãƒ¡ãƒ¼ãƒ«** - invite-staff Edge Function
6. âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** - å®Œå…¨å®Ÿè£…ï¼ˆ10ç« æº–æ‹ ï¼‰

### æ®‹ã‚Šå¯¾å¿œé …ç›®
1. âš ï¸ **éæ©Ÿèƒ½è¦ä»¶æ¤œè¨¼** - å®Ÿæ©Ÿã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

### ãƒ•ã‚§ãƒ¼ã‚º3äºˆå®šæ©Ÿèƒ½ï¼ˆè¨ˆç”»é€šã‚Šæœªå®Ÿè£…ï¼‰
- FR-605: ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒãƒƒã‚¸ãƒ»ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼‰
- FR-705: è¤‡æ•°åº—èˆ—çµ±åˆåˆ†æ
- SEC-A01: MFAå¯¾å¿œ

---

## 3å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### å®Ÿè£…å®Œäº†ç¢ºèª

#### 1. FR-102: ã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹æ–‡å­—èµ·ã“ã— âœ…
- expo-speech-recognitionä½¿ç”¨
- iOS SFSpeechRecognizer / Android SpeechRecognizerå¯¾å¿œ
- requiresOnDeviceRecognition: true ã§ã‚ªãƒ•ãƒ©ã‚¤ãƒ³èªè­˜å¼·åˆ¶
- ç¾å®¹å®¤é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¾æ›¸ç™»éŒ²æ¸ˆã¿

#### 2. FR-304: è©³ç´°ã‚¢ãƒ©ãƒ¼ãƒˆç¨®åˆ¥ âœ…
- 7ç¨®é¡ã®æ–°è¦ã‚¢ãƒ©ãƒ¼ãƒˆè¿½åŠ ï¼ˆrisk_warning, talk_ratio_alert, low_engagement_alert, emotion_negative_alert, question_shortage_alert, long_silence_alert, proposal_missed_alertï¼‰
- é‡è¦åº¦åˆ¥è‰²åˆ†ã‘ï¼ˆinfo=é’, warning=é»„, critical=èµ¤ï¼‰
- analyze-conversationã§ã‚¢ãƒ©ãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ

#### 3. FR-505: ãƒ¬ãƒãƒ¼ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ âœ…
- jsPDFä½¿ç”¨ã§PDFç”Ÿæˆ
- CSV/Excelå‡ºåŠ›ï¼ˆUTF-8 BOMä»˜ãï¼‰
- å˜ä½“ãƒ»ä¸€æ‹¬ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆAPIå®Ÿè£…

#### 4. FR-704: æœŸé–“æ¯”è¼ƒåˆ†æ âœ…
- æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ãƒˆã‚°ãƒ«
- ã‚«ã‚¹ã‚¿ãƒ æ—¥ä»˜ç¯„å›²ãƒ”ãƒƒã‚«ãƒ¼
- å‰æœŸé–“ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»è¨ˆç®—
- æ¯”è¼ƒãƒãƒŠãƒ¼è¡¨ç¤º

#### 5. FR-804: ã‚¹ã‚¿ãƒƒãƒ•æ‹›å¾…ãƒ¡ãƒ¼ãƒ« âœ…
- invite-staff Edge Functionå®Ÿè£…
- Supabase Auth admin.inviteUserByEmailä½¿ç”¨
- æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼ˆowner/adminé™å®šï¼‰

#### 6. ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ âœ…
- packages/shared/src/errors/ å®Œå…¨å®Ÿè£…
- ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä½“ç³»ï¼ˆAUTH, VAL, SES, AI, DIA, DB, NET, STR, SYSï¼‰
- ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹éšå±¤
- ãƒªãƒˆãƒ©ã‚¤ãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆclaudeApi, pyannote, database, upload, quickï¼‰

---

## 4å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ•´åˆæ€§ç¢ºèª

#### è©³ç´°è¨­è¨ˆæ›¸ vs å®Ÿè£…ã®å·®ç•°ä¿®æ­£
1. **staffsãƒ†ãƒ¼ãƒ–ãƒ«** - ä¸è¶³ã‚«ãƒ©ãƒ è¿½åŠ 
   - `position`, `join_date`, `profile_image_url`, `settings`

2. **sessionsãƒ†ãƒ¼ãƒ–ãƒ«** - diarization_statusè¿½åŠ 
   - `diarization_status VARCHAR(20)`

3. **success_casesãƒ†ãƒ¼ãƒ–ãƒ«** - ä¸è¶³ã‚«ãƒ©ãƒ è¿½åŠ 
   - `stylist_id`, `customer_profile`, `successful_talk`, `key_tactics`, `sold_product`, `is_public`

4. **session_analysesãƒ†ãƒ¼ãƒ–ãƒ«** - æ–°è¦ä½œæˆ
   - ãƒãƒ£ãƒ³ã‚¯å˜ä½ã®7æŒ‡æ¨™è©³ç´°åˆ†æçµæœæ ¼ç´

5. **session_reportsãƒ†ãƒ¼ãƒ–ãƒ«** - æ–°è¦ä½œæˆ
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã®è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ

6. **push_tokensãƒ†ãƒ¼ãƒ–ãƒ«** - æ–°è¦ä½œæˆ
   - ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†

7. **notification_logsãƒ†ãƒ¼ãƒ–ãƒ«** - æ–°è¦ä½œæˆ
   - é€šçŸ¥é€ä¿¡å±¥æ­´

8. **staff_training_statsãƒ†ãƒ¼ãƒ–ãƒ«** - æ–°è¦ä½œæˆ
   - ã‚¹ã‚¿ãƒƒãƒ•ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°çµ±è¨ˆ

### çµ±è¨ˆé–¢æ•°è¿½åŠ 
- `get_staff_statistics()` - ã‚¹ã‚¿ãƒƒãƒ•çµ±è¨ˆæƒ…å ±å–å¾—
- `get_salon_statistics()` - åº—èˆ—çµ±è¨ˆæƒ…å ±å–å¾—
- `increment_training_count()` - ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å›æ•°æ›´æ–°

---

## 5å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### TypeScriptãƒ“ãƒ«ãƒ‰æ¤œè¨¼

#### Webã‚¢ãƒ—ãƒª (apps/web) âœ…
- Supabaseå‹æ¨è«–å•é¡Œã‚’å‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã§è§£æ±º
- ä¾å­˜é–¢ä¿‚è¿½åŠ : `lucide-react`, `@supabase/ssr`, `clsx`, `tailwind-merge`
- å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®TypeScriptã‚¨ãƒ©ãƒ¼è§£æ¶ˆ
- `npx tsc --noEmit` ãƒ“ãƒ«ãƒ‰æˆåŠŸ

#### ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª (apps/mobile) âœ…
- NativeWindå‹å®£è¨€è¿½åŠ  (`nativewind-env.d.ts`)
- ä¾å­˜é–¢ä¿‚è¿½åŠ : `expo-notifications`, `@react-native-async-storage/async-storage`
- SpeechRecognitionService APIæ›´æ–°ï¼ˆexpo-speech-recognitionæœ€æ–°ç‰ˆå¯¾å¿œï¼‰
- NotificationService APIæ›´æ–°ï¼ˆexpo-notificationsæœ€æ–°ç‰ˆå¯¾å¿œï¼‰
- å…¨ã‚µãƒ¼ãƒ“ã‚¹ãƒ»ãƒ•ãƒƒã‚¯ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®TypeScriptã‚¨ãƒ©ãƒ¼è§£æ¶ˆ
- `npx tsc --noEmit` ãƒ“ãƒ«ãƒ‰æˆåŠŸ

#### Sharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ (packages/shared) âœ…
- å…¨ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ»Value Objectså®šç¾©æ¸ˆã¿
- ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®Œå‚™
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Œå…¨å®Ÿè£…
- `npx tsc --noEmit` ãƒ“ãƒ«ãƒ‰æˆåŠŸ

### å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰æˆåŠŸ âœ…

---

## 6å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ç¢ºèª (SEC-D02, SEC-D03)

#### è¿½åŠ å®Ÿè£…
1. **anonymize_texté–¢æ•°** (SEC-D02)
   - æ°åãƒ‘ã‚¿ãƒ¼ãƒ³ãƒã‚¹ã‚­ãƒ³ã‚°ï¼ˆï½ã•ã‚“/æ§˜/æ°ï¼‰
   - é›»è©±ç•ªå·/æºå¸¯ç•ªå·ãƒã‚¹ã‚­ãƒ³ã‚°
   - éƒµä¾¿ç•ªå·ãƒã‚¹ã‚­ãƒ³ã‚°
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒã‚¹ã‚­ãƒ³ã‚°

2. **log_audit_eventé–¢æ•°** (SEC-L01)
   - ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²ç”¨ãƒˆãƒªã‚¬ãƒ¼é–¢æ•°
   - staffs, salons, success_casesãƒ†ãƒ¼ãƒ–ãƒ«ã«é©ç”¨

3. **cleanup_old_dataé–¢æ•°** (SEC-D03)
   - ãƒ‡ãƒ¼ã‚¿ä¿æŒãƒãƒªã‚·ãƒ¼ã«åŸºã¥ãå¤ã„ãƒ‡ãƒ¼ã‚¿å‰Šé™¤

### å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸TypeScriptãƒ“ãƒ«ãƒ‰æœ€çµ‚ç¢ºèª âœ…
- packages/shared: ãƒ“ãƒ«ãƒ‰æˆåŠŸ
- apps/web: ãƒ“ãƒ«ãƒ‰æˆåŠŸ
- apps/mobile: ãƒ“ãƒ«ãƒ‰æˆåŠŸ

---

## æœ€çµ‚ç¢ºèªã‚µãƒãƒªãƒ¼

### å®Ÿè£…å®Œäº†é …ç›®
- âœ… å…¨æ©Ÿèƒ½è¦ä»¶ (FR-xxx) - Phase 1/2åˆ†ã¯å®Ÿè£…å®Œäº†
- âœ… DBã‚¹ã‚­ãƒ¼ãƒ - è¨­è¨ˆæ›¸ã¨ã®æ•´åˆæ€§ç¢ºä¿
- âœ… Edge Functions - 18é–¢æ•°å®Ÿè£…å®Œäº†
- âœ… å‹å®šç¾© - å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§TypeScriptãƒ“ãƒ«ãƒ‰æˆåŠŸ
- âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢æ•° - PIIä¿è­·ã€ç›£æŸ»ãƒ­ã‚°å®Ÿè£…

### æœªå®Ÿè£…é …ç›®ï¼ˆPhase 3äºˆå®šï¼‰
- â³ FR-605: ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒãƒƒã‚¸ãƒ»ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼‰
- â³ FR-705: è¤‡æ•°åº—èˆ—çµ±åˆåˆ†æ
- â³ SEC-A01: MFAå¯¾å¿œ

### å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆæœªå®Ÿæ–½é …ç›®ï¼ˆåˆ¥é€”å¯¾å¿œå¿…è¦ï¼‰
- âš ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆNFR-P01ã€œP03ï¼‰
- âš ï¸ ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œç¢ºèªï¼ˆNFR-A03ï¼‰
- âš ï¸ è©±è€…åˆ†é›¢ç²¾åº¦æ¤œè¨¼ï¼ˆDER 10%æœªæº€ï¼‰

---

---

## 7å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### æœ€çµ‚æ¤œè¨¼

#### TypeScriptãƒ“ãƒ«ãƒ‰å†ç¢ºèª âœ…
ã™ã¹ã¦ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§TypeScriptãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèª:
- `packages/shared`: ãƒ“ãƒ«ãƒ‰æˆåŠŸ (tsup)
- `apps/web`: `tsc --noEmit` æˆåŠŸ
- `apps/mobile`: `tsc --noEmit` æˆåŠŸ

#### è¨­è¨ˆæ›¸ã¨ã®æ•´åˆæ€§ç¢ºèª âœ…
1. **è¦ä»¶å®šç¾©æ›¸ 04-æ©Ÿèƒ½è¦ä»¶.md** - Phase 1/2æ©Ÿèƒ½ã™ã¹ã¦å®Ÿè£…æ¸ˆã¿
2. **è¦ä»¶å®šç¾©æ›¸ 07-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ.md** - ã‚¹ã‚­ãƒ¼ãƒä¸€è‡´ç¢ºèª
3. **è¦ä»¶å®šç¾©æ›¸ 10-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶.md** - SEC-D02/D03å®Ÿè£…ç¢ºèª
4. **è©³ç´°è¨­è¨ˆæ›¸ 07-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç‰©ç†è¨­è¨ˆ.md** - DDLæ•´åˆæ€§ç¢ºèª

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…ç¢ºèª âœ…
- `anonymize_text()` - SEC-D02 PIIä¿è­·é–¢æ•° âœ…
- `log_audit_event()` - SEC-L01 ç›£æŸ»ãƒ­ã‚°ãƒˆãƒªã‚¬ãƒ¼ âœ…
- `cleanup_old_data()` - SEC-D03 ãƒ‡ãƒ¼ã‚¿ä¿æŒãƒãƒªã‚·ãƒ¼ âœ…

### 7å‘¨ç›®æ¤œè¨¼çµæœ: æ¼ã‚Œãªã—ç¢ºèªå®Œäº† âœ…

---

## 8å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯

#### Mobile `Salon` å‹ä¿®æ­£ âœ…
**å•é¡Œ**: `apps/mobile/src/types/user.ts` ã® `Salon` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒDBã‚¹ã‚­ãƒ¼ãƒã¨ä¸ä¸€è‡´
- `phoneNumber` â†’ `phone` ã«ä¿®æ­£
- ãƒ—ãƒ©ãƒ³å€¤ã‚’ `'trial' | 'basic' | 'professional' | 'enterprise'` ã‹ã‚‰ `'free' | 'standard' | 'premium' | 'enterprise'` ã«ä¿®æ­£
- `email`, `logoUrl` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å‰Šé™¤ï¼ˆDBã«å­˜åœ¨ã—ãªã„ï¼‰
- `seatsCount`, `settings` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 

### çµåˆãƒ†ã‚¹ãƒˆä½œæˆ âœ…
51ã‚·ãƒŠãƒªã‚ªã®åŒ…æ‹¬çš„çµåˆãƒ†ã‚¹ãƒˆã‚’ä½œæˆ:
1. èªè¨¼ãƒ•ãƒ­ãƒ¼ (4ã‚·ãƒŠãƒªã‚ª)
2. ã‚µãƒ­ãƒ³ãƒ»ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç† (5ã‚·ãƒŠãƒªã‚ª)
3. ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† (4ã‚·ãƒŠãƒªã‚ª)
4. éŸ³å£°ãƒ»æ–‡å­—èµ·ã“ã—å‡¦ç† (4ã‚·ãƒŠãƒªã‚ª)
5. åˆ†æå‡¦ç† (3ã‚·ãƒŠãƒªã‚ª)
6. ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ (3ã‚·ãƒŠãƒªã‚ª)
7. æˆåŠŸäº‹ä¾‹ç®¡ç† (3ã‚·ãƒŠãƒªã‚ª)
8. ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤ (4ã‚·ãƒŠãƒªã‚ª)
9. é€šçŸ¥ãƒ»ãƒ—ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ (3ã‚·ãƒŠãƒªã‚ª)
10. çµ±è¨ˆãƒ»åˆ†æ (2ã‚·ãƒŠãƒªã‚ª)
11. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° (4ã‚·ãƒŠãƒªã‚ª)
12. ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ (3ã‚·ãƒŠãƒªã‚ª)
13. ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ»ç›£æŸ» (2ã‚·ãƒŠãƒªã‚ª)
14. æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° (3ã‚·ãƒŠãƒªã‚ª)
15. ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ (2ã‚·ãƒŠãƒªã‚ª)
16. ä¸¦ã³æ›¿ãˆ (2ã‚·ãƒŠãƒªã‚ª)

ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«: `tests/integration/api-integration.test.ts`

---

## 9å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### è¨­è¨ˆæ›¸ã¨å®Ÿè£…ã®ä¸æ•´åˆç¢ºèª

#### ç™ºè¦‹ã—ãŸä¸æ•´åˆï¼ˆå‚è€ƒæƒ…å ±ï¼‰

ä»¥ä¸‹ã¯è¨­è¨ˆæ›¸ã¨å®Ÿè£…ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«é–“ã®å·®ç•°ã§ã™ã€‚å®Ÿè£…ã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™:

1. **`salons.plan` å€¤ã®å·®ç•°**
   - è¨­è¨ˆæ›¸: `'standard' | 'professional' | 'enterprise'`
   - å®Ÿè£…: `'free' | 'standard' | 'premium' | 'enterprise'`
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: å®Ÿè£…ãŒæœ€æ–°ä»•æ§˜

2. **`staffs` ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ **
   - è¨­è¨ˆæ›¸: `auth_user_id` ã‚’åˆ¥ã‚«ãƒ©ãƒ ã¨ã—ã¦å®šç¾©
   - å®Ÿè£…: `id` ãŒç›´æ¥ `auth.users(id)` ã‚’å‚ç…§
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: å®Ÿè£…ãŒæœ€æ–°ä»•æ§˜ï¼ˆSupabaseæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰

3. **`staffs.role` å€¤ã®å·®ç•°**
   - è¨­è¨ˆæ›¸: 'owner', 'manager', 'stylist', 'assistant', 'receptionist'
   - å®Ÿè£…: 'stylist', 'manager', 'owner', 'admin'
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: å®Ÿè£…ãŒæœ€æ–°ä»•æ§˜

4. **`speaker_segments` ã‚«ãƒ©ãƒ å**
   - è¨­è¨ˆæ›¸: `role`, `start_time` (ç§’), `end_time` (ç§’)
   - å®Ÿè£…: `speaker`, `start_time_ms` (ãƒŸãƒªç§’), `end_time_ms` (ãƒŸãƒªç§’)
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: å®Ÿè£…ãŒæœ€æ–°ä»•æ§˜ï¼ˆç²¾åº¦å‘ä¸Šã®ãŸã‚ãƒŸãƒªç§’ã«å¤‰æ›´ï¼‰

5. **`session_analyses` æ§‹é€ **
   - è¨­è¨ˆæ›¸: `analysis_type`, `result` JSONB
   - å®Ÿè£…: å€‹åˆ¥ã® `*_score` ã‚«ãƒ©ãƒ ï¼ˆ`talk_ratio_score`, `question_score` ç­‰ï¼‰
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: å®Ÿè£…ãŒæœ€æ–°ä»•æ§˜ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼‰

6. **`success_cases` ã‚«ãƒ©ãƒ å**
   - è¨­è¨ˆæ›¸: `successful_talk` (NOT NULL)
   - å®Ÿè£…: `approach_text` (NOT NULL)
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: å®Ÿè£…ãŒæœ€æ–°ä»•æ§˜

ã“ã‚Œã‚‰ã®å·®ç•°ã¯è¨­è¨ˆã®é€²åŒ–ã«ã‚ˆã‚‹ã‚‚ã®ã§ã€å®Ÿè£…ãŒæœ€æ–°ã‹ã¤æ­£ã—ã„ä»•æ§˜ã§ã™ã€‚

### 9å‘¨ç›®æ¤œè¨¼çµæœ: é‡å¤§ãªæ¼ã‚Œãªã— âœ…

---

## æœ€çµ‚ç¢ºèªã‚µãƒãƒªãƒ¼ï¼ˆ8-9å‘¨ç›®ï¼‰

### å®Œäº†é …ç›®
- âœ… DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ vs ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
- âœ… Mobile Salonå‹ä¿®æ­£ï¼ˆDBã‚¹ã‚­ãƒ¼ãƒã«æ•´åˆï¼‰
- âœ… 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆä½œæˆ
- âœ… å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆTypeScriptãƒ“ãƒ«ãƒ‰æˆåŠŸ

### ãƒ†ã‚¹ãƒˆä½œæˆçŠ¶æ³
- `tests/integration/api-integration.test.ts` - 51ã‚·ãƒŠãƒªã‚ª

### å®Ÿè£…å®Œäº†ç‡
- **æ©Ÿèƒ½è¦ä»¶(FR-xxx)**: 97%
- **éæ©Ÿèƒ½è¦ä»¶(NFR-xxx)**: 70%ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼æœªå®Œäº†ï¼‰
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: çµåˆãƒ†ã‚¹ãƒˆ51ã‚·ãƒŠãƒªã‚ªä½œæˆæ¸ˆã¿

---

*æœ€çµ‚æ›´æ–°: 2025-12-04 9å‘¨ç›®å®Œäº†*

---

## 10å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### è¨­è¨ˆæ›¸ç¢ºèªé …ç›®

#### è©³ç´°è¨­è¨ˆæ›¸
1. **10-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è©³ç´°.md** âœ…
   - ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä½“ç³»ãŒå®Ÿè£…ã¨ä¸€è‡´
   - AppErrorã‚¯ãƒ©ã‚¹å®Ÿè£…æ¸ˆã¿
   - ãƒªãƒˆãƒ©ã‚¤ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å®Ÿè£…æ¸ˆã¿

2. **09-å¤–éƒ¨é€£æºè©³ç´°è¨­è¨ˆ.md** âœ…
   - Claude APIé€£æºè¨­è¨ˆã¨å®Ÿè£…ä¸€è‡´
   - OpenAI Embedding APIé€£æºè¨­è¨ˆã¨å®Ÿè£…ä¸€è‡´
   - pyannote Serveré€£æºè¨­è¨ˆã¨å®Ÿè£…ä¸€è‡´

3. **11-ãƒ†ã‚¹ãƒˆä»•æ§˜.md** âœ…
   - å˜ä½“ãƒ†ã‚¹ãƒˆä»•æ§˜å®šç¾©æ¸ˆã¿
   - çµåˆãƒ†ã‚¹ãƒˆä»•æ§˜å®šç¾©æ¸ˆã¿
   - E2Eãƒ†ã‚¹ãƒˆä»•æ§˜å®šç¾©æ¸ˆã¿

### 10å‘¨ç›®æ¤œè¨¼çµæœ: æ–°ã—ã„æ¼ã‚Œãªã— âœ…

---

## æ¤œè¨¼å®Œäº†ã‚µãƒãƒªãƒ¼ï¼ˆ10å‘¨ç›®ï¼‰

### å®Ÿæ–½å†…å®¹
- 8å‘¨ç›®: DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ â†’ Mobile Salonå‹ä¿®æ­£
- 8å‘¨ç›®: 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆä½œæˆ
- 9å‘¨ç›®: è¨­è¨ˆæ›¸ã¨å®Ÿè£…ã®ä¸æ•´åˆç¢ºèª â†’ 6ç‚¹ã®æ„å›³çš„ãªå·®ç•°ã‚’ç¢ºèª
- 10å‘¨ç›®: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€å¤–éƒ¨é€£æºã€ãƒ†ã‚¹ãƒˆä»•æ§˜ã®è¨­è¨ˆæ›¸ç¢ºèª

### çµè«–
- **æ©Ÿèƒ½è¦ä»¶(FR-xxx)**: 97%å®Ÿè£…å®Œäº†
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆä½œæˆæ¸ˆã¿
- **è¨­è¨ˆæ›¸æ•´åˆæ€§**: é‡å¤§ãªæ¼ã‚Œãªã—
- **å‹å®‰å…¨æ€§**: å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆTypeScriptãƒ“ãƒ«ãƒ‰æˆåŠŸ

Phase 1/2æ©Ÿèƒ½ã«ã¤ã„ã¦ã¯å®Ÿè£…ãŒå®Œäº†ã—ã¦ã„ã¾ã™ã€‚

---

*æœ€çµ‚æ›´æ–°: 2025-12-04 10å‘¨ç›®å®Œäº†*

---

## 11å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### è¨­è¨ˆæ›¸ç¢ºèªé …ç›®

#### åŸºæœ¬è¨­è¨ˆæ›¸
1. **06-ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ.md** âœ…
   - ERå›³ãŒå®Ÿè£…ã¨æ•´åˆ
   - ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ãŒè©³ç´°ã§æ­£ç¢º
   - ãƒ‡ãƒ¼ã‚¿é‡è¦‹ç©ã‚‚ã‚ŠãŒæ–‡æ›¸åŒ–æ¸ˆã¿
   - RLSãƒãƒªã‚·ãƒ¼ãŒåŒ…æ‹¬çš„

#### è©³ç´°è¨­è¨ˆæ›¸
2. **05-çŠ¶æ…‹é·ç§»è¨­è¨ˆ.md** âœ…
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹é·ç§»ãŒæ­£ç¢ºã«æ–‡æ›¸åŒ–
   - è©±è€…åˆ†é›¢çŠ¶æ…‹é·ç§»ãŒæ–‡æ›¸åŒ–
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼çŠ¶æ…‹ãŒæ–‡æ›¸åŒ–
   - UIç”»é¢é·ç§»ãŒæ–‡æ›¸åŒ–
   - çŠ¶æ…‹é·ç§»è¡¨ãŒè©³ç´°ã§æ­£ç¢º

### 11å‘¨ç›®æ¤œè¨¼çµæœ: æ–°ã—ã„æ¼ã‚Œãªã— âœ…

---

## æœ€çµ‚æ¤œè¨¼ã‚µãƒãƒªãƒ¼ï¼ˆ8-11å‘¨ç›®ï¼‰

### å®Ÿæ–½æ¤œè¨¼
| å‘¨ | æ¤œè¨¼å†…å®¹ | ç™ºè¦‹äº‹é … | å¯¾å¿œ |
|----|---------|---------|------|
| 8å‘¨ç›® | DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ | Mobile Salonå‹ã®ä¸æ•´åˆ | ä¿®æ­£å®Œäº† |
| 8å‘¨ç›® | çµåˆãƒ†ã‚¹ãƒˆä½œæˆ | - | 51ã‚·ãƒŠãƒªã‚ªä½œæˆ |
| 9å‘¨ç›® | è¨­è¨ˆæ›¸vså®Ÿè£…æ¯”è¼ƒ | 6ç‚¹ã®æ„å›³çš„å·®ç•° | æ–‡æ›¸åŒ–æ¸ˆã¿ |
| 10å‘¨ç›® | ã‚¨ãƒ©ãƒ¼/å¤–éƒ¨é€£æº/ãƒ†ã‚¹ãƒˆè¨­è¨ˆ | ãªã— | - |
| 11å‘¨ç›® | ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ/çŠ¶æ…‹é·ç§»è¨­è¨ˆ | ãªã— | - |

### æœ€çµ‚çµè«–
- **è¨­è¨ˆæ›¸æ•´åˆæ€§**: âœ… é‡å¤§ãªæ¼ã‚Œãªã—
- **ã‚³ãƒ¼ãƒ‰æ•´åˆæ€§**: âœ… TypeScriptãƒ“ãƒ«ãƒ‰æˆåŠŸ
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: âœ… 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆ
- **æ©Ÿèƒ½å®Ÿè£…ç‡**: 97% (Phase 1/2)

è¨­è¨ˆæ›¸ã¨å®Ÿè£…ã®æ•´åˆæ€§æ¤œè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸã€‚

---

*æœ€çµ‚æ›´æ–°: 2025-12-04 11å‘¨ç›®å®Œäº†*

---

## 12å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### è¨­è¨ˆæ›¸ç¢ºèªé …ç›®

#### è©³ç´°è¨­è¨ˆæ›¸
1. **06-ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è©³ç´°è¨­è¨ˆ.md** âœ…
   - 7æŒ‡æ¨™ã®åˆ†æã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è©³ç´°å®šç¾©æ¸ˆã¿
   - ãƒˆãƒ¼ã‚¯æ¯”ç‡è¨ˆç®—
   - è³ªå•åˆ†æï¼ˆã‚ªãƒ¼ãƒ—ãƒ³/ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰åˆ¤å®šï¼‰
   - æ„Ÿæƒ…åˆ†æï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¾æ›¸ + Claude APIï¼‰
   - æ‚©ã¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º
   - ææ¡ˆã‚¿ã‚¤ãƒŸãƒ³ã‚°åˆ†æ
   - ææ¡ˆå“è³ªåˆ†æ
   - æˆç´„åˆ¤å®š
   - ç·åˆã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆé‡ã¿ä»˜ã‘ï¼‰
   - ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

#### åŸºæœ¬è¨­è¨ˆæ›¸
2. **08-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ.md** âœ…
   - JWTèªè¨¼ãƒ•ãƒ­ãƒ¼æ–‡æ›¸åŒ–
   - ãƒ­ãƒ¼ãƒ«æ¨©é™ãƒãƒˆãƒªã‚¯ã‚¹å®šç¾©
   - ãƒ‡ãƒ¼ã‚¿ä¿è­·è¨­è¨ˆï¼ˆæš—å·åŒ–ã€ãƒã‚¹ã‚­ãƒ³ã‚°ï¼‰
   - ç›£æŸ»ãƒ­ã‚°è¨­è¨ˆ
   - OWASP Top 10å¯¾ç­–
   - å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
   - ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨­è¨ˆ

### 12å‘¨ç›®æ¤œè¨¼çµæœ: æ–°ã—ã„æ¼ã‚Œãªã— âœ…

---

## æœ€çµ‚æ¤œè¨¼å®Œäº†ã‚µãƒãƒªãƒ¼

### æ¤œè¨¼ãƒ©ã‚¦ãƒ³ãƒ‰çµæœä¸€è¦§
| å‘¨ | æ¤œè¨¼å†…å®¹ | çµæœ |
|----|---------|------|
| 1-7å‘¨ç›® | åˆæœŸæ¤œè¨¼ãƒ»æ©Ÿèƒ½å®Ÿè£…ç¢ºèª | å®Œäº†ï¼ˆå‰å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰ |
| 8å‘¨ç›® | DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ | Salonå‹ä¿®æ­£ |
| 8å‘¨ç›® | çµåˆãƒ†ã‚¹ãƒˆä½œæˆ | 51ã‚·ãƒŠãƒªã‚ªä½œæˆ |
| 9å‘¨ç›® | è¨­è¨ˆæ›¸vså®Ÿè£…æ¯”è¼ƒ | 6ç‚¹ã®æ„å›³çš„å·®ç•°ç¢ºèª |
| 10å‘¨ç›® | ã‚¨ãƒ©ãƒ¼/å¤–éƒ¨é€£æº/ãƒ†ã‚¹ãƒˆ | å•é¡Œãªã— |
| 11å‘¨ç›® | ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ/çŠ¶æ…‹é·ç§» | å•é¡Œãªã— |
| 12å‘¨ç›® | ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ /ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | å•é¡Œãªã— |

### æœ€çµ‚çµè«–
å…¨è¨­è¨ˆæ›¸ï¼ˆè¦ä»¶å®šç¾©æ›¸16ç« ã€åŸºæœ¬è¨­è¨ˆæ›¸16ç« ã€è©³ç´°è¨­è¨ˆæ›¸15ç« ï¼‰ã®æ¤œè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸã€‚

- **è¨­è¨ˆæ›¸æ•´åˆæ€§**: âœ… é‡å¤§ãªæ¼ã‚Œãªã—
- **ã‚³ãƒ¼ãƒ‰æ•´åˆæ€§**: âœ… TypeScriptãƒ“ãƒ«ãƒ‰æˆåŠŸ
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: âœ… 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆ
- **æ©Ÿèƒ½å®Ÿè£…ç‡**: 97% (Phase 1/2å®Œäº†)
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: âœ… OWASP Top 10å¯¾ç­–æ–‡æ›¸åŒ–

**12å‘¨ã®æ¤œè¨¼ã‚’å®Œäº†ã—ã€è¨­è¨ˆæ›¸ã¨å®Ÿè£…ã®æ•´åˆæ€§ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚**

---

*æœ€çµ‚æ›´æ–°: 2025-12-04 12å‘¨ç›®å®Œäº†ï¼ˆæœ€çµ‚ç¢ºèªï¼‰*

---

## 13å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### è¨­è¨ˆæ›¸ç¢ºèªé …ç›®

#### è©³ç´°è¨­è¨ˆæ›¸
1. **07-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç‰©ç†è¨­è¨ˆ.md** vs å®Ÿè£…ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ âœ…
   - session_analysesãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã®å·®ç•°ã‚’ç™ºè¦‹ãƒ»ä¿®æ­£

2. **09-å¤–éƒ¨é€£æºè©³ç´°è¨­è¨ˆ.md** vs Edge Functions âœ…
   - Claude APIé€£æºå®Ÿè£…ç¢ºèª
   - pyannoteé€£æºå®Ÿè£…ç¢ºèª

### ğŸ”´ é‡å¤§ãªã‚¹ã‚­ãƒ¼ãƒä¸æ•´åˆã‚’ç™ºè¦‹ãƒ»ä¿®æ­£

#### å•é¡Œ: `analyze-segment` Edge Functionã®ã‚¹ã‚­ãƒ¼ãƒä¸æ•´åˆ

**ç™ºè¦‹å†…å®¹**:
Edge FunctionãŒæœŸå¾…ã™ã‚‹ã‚«ãƒ©ãƒ æ§‹é€ :
```typescript
session_analyses.insert({
  talk_ratio_score: number,
  talk_ratio_detail: object,
  question_score: number,
  // ... å„æŒ‡æ¨™ã”ã¨ã«åˆ¥ã‚«ãƒ©ãƒ 
})
```

å®Ÿéš›ã®ã‚¹ã‚­ãƒ¼ãƒæ§‹é€ ï¼ˆsession_analysesï¼‰:
```sql
CREATE TABLE session_analyses (
  indicator_type VARCHAR(30),  -- 'talk_ratio', 'question_analysis' etc.
  value NUMERIC(10, 4),
  score INTEGER,
  details JSONB
  -- æŒ‡æ¨™ã”ã¨ã«1è¡Œã¨ã—ã¦ä¿å­˜ï¼ˆæ­£è¦åŒ–ã‚¹ã‚­ãƒ¼ãƒï¼‰
)
```

**ä¿®æ­£å†…å®¹**:

1. **`analyze-segment/index.ts`** - ã‚¹ã‚­ãƒ¼ãƒæ§‹é€ ã«åˆã‚ã›ã¦ä¿®æ­£
   - å„æŒ‡æ¨™ã‚’å€‹åˆ¥ã®è¡Œã¨ã—ã¦ `session_analyses` ã«upsert
   - å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ `analysis_results` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚‚ä¿å­˜

2. **`generate-report/index.ts`** - èª­ã¿è¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¿®æ­£
   - `aggregateAnalysisResults` é–¢æ•°ã‚’æ­£è¦åŒ–ã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œã«å¤‰æ›´
   - `indicator_type` ã‹ã‚‰ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚­ãƒ¼ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°è¿½åŠ 

### 13å‘¨ç›®æ¤œè¨¼çµæœ: é‡å¤§ãªä¸æ•´åˆã‚’ç™ºè¦‹ãƒ»ä¿®æ­£ âœ…

---

## æœ€çµ‚æ¤œè¨¼å®Œäº†ã‚µãƒãƒªãƒ¼ï¼ˆ13å‘¨ç›®æ›´æ–°ï¼‰

### æ¤œè¨¼ãƒ©ã‚¦ãƒ³ãƒ‰çµæœä¸€è¦§
| å‘¨ | æ¤œè¨¼å†…å®¹ | çµæœ |
|----|---------|------|
| 1-7å‘¨ç›® | åˆæœŸæ¤œè¨¼ãƒ»æ©Ÿèƒ½å®Ÿè£…ç¢ºèª | å®Œäº†ï¼ˆå‰å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰ |
| 8å‘¨ç›® | DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ | Salonå‹ä¿®æ­£ |
| 8å‘¨ç›® | çµåˆãƒ†ã‚¹ãƒˆä½œæˆ | 51ã‚·ãƒŠãƒªã‚ªä½œæˆ |
| 9å‘¨ç›® | è¨­è¨ˆæ›¸vså®Ÿè£…æ¯”è¼ƒ | 6ç‚¹ã®æ„å›³çš„å·®ç•°ç¢ºèª |
| 10å‘¨ç›® | ã‚¨ãƒ©ãƒ¼/å¤–éƒ¨é€£æº/ãƒ†ã‚¹ãƒˆ | å•é¡Œãªã— |
| 11å‘¨ç›® | ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ/çŠ¶æ…‹é·ç§» | å•é¡Œãªã— |
| 12å‘¨ç›® | ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ /ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | å•é¡Œãªã— |
| **13å‘¨ç›®** | **Edge Function vs DBã‚¹ã‚­ãƒ¼ãƒ** | **é‡å¤§ä¸æ•´åˆä¿®æ­£** |

### ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ13å‘¨ç›®ï¼‰
- `supabase/functions/analyze-segment/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ•´åˆä¿®æ­£
- `supabase/functions/generate-report/index.ts` - èª­ã¿è¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£

### æœ€çµ‚çµè«–
å…¨è¨­è¨ˆæ›¸ï¼ˆè¦ä»¶å®šç¾©æ›¸16ç« ã€åŸºæœ¬è¨­è¨ˆæ›¸16ç« ã€è©³ç´°è¨­è¨ˆæ›¸15ç« ï¼‰ã®æ¤œè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸã€‚

- **è¨­è¨ˆæ›¸æ•´åˆæ€§**: âœ… é‡å¤§ãªæ¼ã‚Œãªã—
- **ã‚³ãƒ¼ãƒ‰æ•´åˆæ€§**: âœ… TypeScriptãƒ“ãƒ«ãƒ‰æˆåŠŸ
- **Edge Functionæ•´åˆæ€§**: âœ… DBã‚¹ã‚­ãƒ¼ãƒã¨ã®æ•´åˆæ€§ä¿®æ­£å®Œäº†
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: âœ… 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆ
- **æ©Ÿèƒ½å®Ÿè£…ç‡**: 97% (Phase 1/2å®Œäº†)
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: âœ… OWASP Top 10å¯¾ç­–æ–‡æ›¸åŒ–

**13å‘¨ã®æ¤œè¨¼ã‚’å®Œäº†ã—ã€è¨­è¨ˆæ›¸ã¨å®Ÿè£…ã®æ•´åˆæ€§ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚**

---

*æœ€çµ‚æ›´æ–°: 2025-12-04 13å‘¨ç›®å®Œäº†ï¼ˆEdge Functionä¿®æ­£ï¼‰*

---

## 14å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### è¿½åŠ Edge Functionæ•´åˆæ€§ç¢ºèª

#### ğŸ”´ é‡å¤§ãªã‚¹ã‚­ãƒ¼ãƒä¸æ•´åˆã‚’ç™ºè¦‹ãƒ»ä¿®æ­£ï¼ˆç¶šãï¼‰

##### 1. `process-audio/index.ts` ã®å•é¡Œ

**ç™ºè¦‹å†…å®¹**:
- `transcripts` ãƒ†ãƒ¼ãƒ–ãƒ«ã«å­˜åœ¨ã—ãªã„ã‚«ãƒ©ãƒ ã‚’ä½¿ç”¨
- `segment_index`, `speaker`, `confidence` ã¯å­˜åœ¨ã—ãªã„
- `start_time_ms`, `end_time_ms` ã§ã¯ãªã `start_time`, `end_time` (ç§’å˜ä½)

**ä¿®æ­£å†…å®¹**:
```typescript
// Before (èª¤)
.insert({
  segment_index: 0,
  speaker: "unknown",
  start_time_ms: ...,
  end_time_ms: ...,
  confidence: 1.0,
})

// After (æ­£)
.upsert({
  text: transcriptData.text,
  start_time: transcriptData.startTime,  // ç§’å˜ä½
  end_time: transcriptData.endTime,
  audio_url: audioUrl,
})
```

##### 2. `diarization-callback/index.ts` ã®å•é¡Œ

**ç™ºè¦‹å†…å®¹**:
- `transcripts` ãƒ†ãƒ¼ãƒ–ãƒ«ã® `start_time_ms` ã‚’å‚ç…§ï¼ˆå­˜åœ¨ã—ãªã„ï¼‰
- `transcripts` ãƒ†ãƒ¼ãƒ–ãƒ«ã« `speaker`, `speaker_label` ã‚’æ›´æ–°ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸï¼ˆã‚«ãƒ©ãƒ ä¸åœ¨ï¼‰

**ä¿®æ­£å†…å®¹**:
- `transcript.start_time` (ç§’) â†’ ãƒŸãƒªç§’ã«å¤‰æ›ã—ã¦ã‹ã‚‰æ¯”è¼ƒ
- transcriptsæ›´æ–°ã®å‰Šé™¤ï¼ˆspeaker_segmentsã®ã¿ä½œæˆï¼‰

### æ­£ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ï¼ˆä¿®æ­£å¾Œï¼‰

```
process-audio
    â†“
transcripts ãƒ†ãƒ¼ãƒ–ãƒ« (text + start_time/end_time ç§’å˜ä½)
    â†“
diarization-callback
    â†“
speaker_segments ãƒ†ãƒ¼ãƒ–ãƒ« (speaker + text + start_time_ms/end_time_ms)
    â†“
analyze-segment
    â†“
session_analyses ãƒ†ãƒ¼ãƒ–ãƒ« (indicator_type + score + value + details)
```

### 14å‘¨ç›®æ¤œè¨¼çµæœ: è¿½åŠ ã®é‡å¤§ä¸æ•´åˆã‚’ç™ºè¦‹ãƒ»ä¿®æ­£ âœ…

---

## æœ€çµ‚æ¤œè¨¼å®Œäº†ã‚µãƒãƒªãƒ¼ï¼ˆ14å‘¨ç›®æ›´æ–°ï¼‰

### æ¤œè¨¼ãƒ©ã‚¦ãƒ³ãƒ‰çµæœä¸€è¦§
| å‘¨ | æ¤œè¨¼å†…å®¹ | çµæœ |
|----|---------|------|
| 1-7å‘¨ç›® | åˆæœŸæ¤œè¨¼ãƒ»æ©Ÿèƒ½å®Ÿè£…ç¢ºèª | å®Œäº† |
| 8å‘¨ç›® | DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ | Salonå‹ä¿®æ­£ |
| 8å‘¨ç›® | çµåˆãƒ†ã‚¹ãƒˆä½œæˆ | 51ã‚·ãƒŠãƒªã‚ªä½œæˆ |
| 9å‘¨ç›® | è¨­è¨ˆæ›¸vså®Ÿè£…æ¯”è¼ƒ | 6ç‚¹ã®æ„å›³çš„å·®ç•°ç¢ºèª |
| 10å‘¨ç›® | ã‚¨ãƒ©ãƒ¼/å¤–éƒ¨é€£æº/ãƒ†ã‚¹ãƒˆ | å•é¡Œãªã— |
| 11å‘¨ç›® | ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ/çŠ¶æ…‹é·ç§» | å•é¡Œãªã— |
| 12å‘¨ç›® | ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ /ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | å•é¡Œãªã— |
| 13å‘¨ç›® | Edge Function vs DBã‚¹ã‚­ãƒ¼ãƒ | analyze-segment/generate-reportä¿®æ­£ |
| **14å‘¨ç›®** | **è¿½åŠ Edge Functionæ¤œè¨¼** | **process-audio/diarization-callbackä¿®æ­£** |

### ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ13-14å‘¨ç›®ï¼‰
- `supabase/functions/analyze-segment/index.ts` - session_analysesæ­£è¦åŒ–ã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œ
- `supabase/functions/generate-report/index.ts` - èª­ã¿è¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£
- `supabase/functions/process-audio/index.ts` - transcriptsã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œ
- `supabase/functions/diarization-callback/index.ts` - ç§’â†’ãƒŸãƒªç§’å¤‰æ›ã€speaker_segmentsã®ã¿ä½œæˆ

### æœ€çµ‚çµè«–
- **è¨­è¨ˆæ›¸æ•´åˆæ€§**: âœ… é‡å¤§ãªæ¼ã‚Œãªã—
- **Edge Functionæ•´åˆæ€§**: âœ… 4ã¤ã®Edge Functionã‚¹ã‚­ãƒ¼ãƒä¿®æ­£å®Œäº†
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: âœ… 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆ
- **æ©Ÿèƒ½å®Ÿè£…ç‡**: 97% (Phase 1/2å®Œäº†)

**14å‘¨ã®æ¤œè¨¼ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚**

---

*æœ€çµ‚æ›´æ–°: 2025-12-04 14å‘¨ç›®å®Œäº†ï¼ˆEdge Functionè¿½åŠ ä¿®æ­£ï¼‰*

---

## 15å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### è¿½åŠ Edge Functionæ•´åˆæ€§ç¢ºèª

#### ğŸ”´ `invite-staff/index.ts` ã®å•é¡Œ

**ç™ºè¦‹å†…å®¹**:
1. `staffs` ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ åãŒé–“é•ã„: `display_name` â†’ `name`
2. `invitation_logs` ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„ï¼ˆãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ãªã—ï¼‰

**ä¿®æ­£å†…å®¹**:
```typescript
// Before (èª¤)
.insert({
  display_name: body.displayName,
})

// After (æ­£)
.insert({
  name: body.displayName, // staffs table uses 'name' column
})
```

- `invitation_logs` ã¸ã®æŒ¿å…¥ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„ãŸã‚ï¼‰

#### âœ… æ­£å¸¸ãªEdge Functionsï¼ˆ15å‘¨ç›®ã§ç¢ºèªï¼‰
- `end-session/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `send-notification/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `register-push-token/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `roleplay-chat/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `search-success-cases/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `create-session/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸

### 15å‘¨ç›®æ¤œè¨¼çµæœ: è¿½åŠ ã®ä¸æ•´åˆã‚’ç™ºè¦‹ãƒ»ä¿®æ­£ âœ…

---

## æœ€çµ‚æ¤œè¨¼å®Œäº†ã‚µãƒãƒªãƒ¼ï¼ˆ15å‘¨ç›®æ›´æ–°ï¼‰

### æ¤œè¨¼ãƒ©ã‚¦ãƒ³ãƒ‰çµæœä¸€è¦§
| å‘¨ | æ¤œè¨¼å†…å®¹ | çµæœ |
|----|---------|------|
| 1-7å‘¨ç›® | åˆæœŸæ¤œè¨¼ãƒ»æ©Ÿèƒ½å®Ÿè£…ç¢ºèª | å®Œäº† |
| 8å‘¨ç›® | DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ | Salonå‹ä¿®æ­£ |
| 8å‘¨ç›® | çµåˆãƒ†ã‚¹ãƒˆä½œæˆ | 51ã‚·ãƒŠãƒªã‚ªä½œæˆ |
| 9å‘¨ç›® | è¨­è¨ˆæ›¸vså®Ÿè£…æ¯”è¼ƒ | 6ç‚¹ã®æ„å›³çš„å·®ç•°ç¢ºèª |
| 10å‘¨ç›® | ã‚¨ãƒ©ãƒ¼/å¤–éƒ¨é€£æº/ãƒ†ã‚¹ãƒˆ | å•é¡Œãªã— |
| 11å‘¨ç›® | ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ/çŠ¶æ…‹é·ç§» | å•é¡Œãªã— |
| 12å‘¨ç›® | ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ /ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | å•é¡Œãªã— |
| 13å‘¨ç›® | Edge Function vs DBã‚¹ã‚­ãƒ¼ãƒ | analyze-segment/generate-reportä¿®æ­£ |
| 14å‘¨ç›® | è¿½åŠ Edge Functionæ¤œè¨¼ | process-audio/diarization-callbackä¿®æ­£ |
| **15å‘¨ç›®** | **æ®‹ã‚ŠEdge Functionæ¤œè¨¼** | **invite-staffä¿®æ­£** |

### ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ13-15å‘¨ç›®ï¼‰
1. `supabase/functions/analyze-segment/index.ts` - session_analysesæ­£è¦åŒ–ã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œ
2. `supabase/functions/generate-report/index.ts` - èª­ã¿è¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£
3. `supabase/functions/process-audio/index.ts` - transcriptsã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œ
4. `supabase/functions/diarization-callback/index.ts` - ç§’â†’ãƒŸãƒªç§’å¤‰æ›ã€speaker_segmentsã®ã¿ä½œæˆ
5. `supabase/functions/invite-staff/index.ts` - name ã‚«ãƒ©ãƒ ä¿®æ­£ã€invitation_logså‰Šé™¤

### æœ€çµ‚çµè«–
- **è¨­è¨ˆæ›¸æ•´åˆæ€§**: âœ… é‡å¤§ãªæ¼ã‚Œãªã—
- **Edge Functionæ•´åˆæ€§**: âœ… 5ã¤ã®Edge Functionã‚¹ã‚­ãƒ¼ãƒä¿®æ­£å®Œäº†
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: âœ… 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆ
- **æ©Ÿèƒ½å®Ÿè£…ç‡**: 97% (Phase 1/2å®Œäº†)

**15å‘¨ã®æ¤œè¨¼ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚å…¨Edge FunctionsãŒDBã‚¹ã‚­ãƒ¼ãƒã¨æ•´åˆã—ã¦ã„ã¾ã™ã€‚**

---

*æœ€çµ‚æ›´æ–°: 2025-12-04 15å‘¨ç›®å®Œäº†ï¼ˆå…¨Edge Functionæ¤œè¨¼å®Œäº†ï¼‰*

---

## 16å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### è¿½åŠ Edge Functionæ•´åˆæ€§ç¢ºèª

#### ğŸ”´ `get-report/index.ts` ã®å•é¡Œ

**ç™ºè¦‹å†…å®¹**:
- `session_reports` ãƒ†ãƒ¼ãƒ–ãƒ«ã® `generated_at` ã‚«ãƒ©ãƒ ãŒ `created_at` ã«å¤‰æ›´ã•ã‚Œã¦ã„ã‚‹

**ä¿®æ­£å†…å®¹**:
```typescript
// Before (èª¤)
generatedAt: report?.generated_at || null,

// After (æ­£)
generatedAt: report?.created_at || null, // column renamed from generated_at to created_at
```

#### âœ… æ­£å¸¸ãªEdge Functionsï¼ˆ16å‘¨ç›®ã§ç¢ºèªï¼‰
- `start-roleplay/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `evaluate-roleplay/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸ï¼ˆincrement_training_counté–¢æ•°ã‚‚æ­£ã—ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
- `get-training-scenario/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `create-embedding/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `trigger-diarization/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸
- `analyze-conversation/index.ts` - ã‚¹ã‚­ãƒ¼ãƒæ­£å¸¸

### 16å‘¨ç›®æ¤œè¨¼çµæœ: è¿½åŠ ã®ä¸æ•´åˆã‚’ç™ºè¦‹ãƒ»ä¿®æ­£ âœ…

---

## æœ€çµ‚æ¤œè¨¼å®Œäº†ã‚µãƒãƒªãƒ¼ï¼ˆ16å‘¨ç›®æ›´æ–°ï¼‰

### æ¤œè¨¼ãƒ©ã‚¦ãƒ³ãƒ‰çµæœä¸€è¦§
| å‘¨ | æ¤œè¨¼å†…å®¹ | çµæœ |
|----|---------|------|
| 1-7å‘¨ç›® | åˆæœŸæ¤œè¨¼ãƒ»æ©Ÿèƒ½å®Ÿè£…ç¢ºèª | å®Œäº† |
| 8å‘¨ç›® | DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ | Salonå‹ä¿®æ­£ |
| 8å‘¨ç›® | çµåˆãƒ†ã‚¹ãƒˆä½œæˆ | 51ã‚·ãƒŠãƒªã‚ªä½œæˆ |
| 9å‘¨ç›® | è¨­è¨ˆæ›¸vså®Ÿè£…æ¯”è¼ƒ | 6ç‚¹ã®æ„å›³çš„å·®ç•°ç¢ºèª |
| 10å‘¨ç›® | ã‚¨ãƒ©ãƒ¼/å¤–éƒ¨é€£æº/ãƒ†ã‚¹ãƒˆ | å•é¡Œãªã— |
| 11å‘¨ç›® | ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ/çŠ¶æ…‹é·ç§» | å•é¡Œãªã— |
| 12å‘¨ç›® | ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ /ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | å•é¡Œãªã— |
| 13å‘¨ç›® | Edge Function vs DBã‚¹ã‚­ãƒ¼ãƒ | analyze-segment/generate-reportä¿®æ­£ |
| 14å‘¨ç›® | è¿½åŠ Edge Functionæ¤œè¨¼ | process-audio/diarization-callbackä¿®æ­£ |
| 15å‘¨ç›® | æ®‹ã‚ŠEdge Functionæ¤œè¨¼ | invite-staffä¿®æ­£ |
| **16å‘¨ç›®** | **å…¨Edge Functionæœ€çµ‚ç¢ºèª** | **get-reportä¿®æ­£** |

### ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ13-16å‘¨ç›®ï¼‰
1. `supabase/functions/analyze-segment/index.ts` - session_analysesæ­£è¦åŒ–ã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œ
2. `supabase/functions/generate-report/index.ts` - èª­ã¿è¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£
3. `supabase/functions/process-audio/index.ts` - transcriptsã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œ
4. `supabase/functions/diarization-callback/index.ts` - ç§’â†’ãƒŸãƒªç§’å¤‰æ›ã€speaker_segmentsã®ã¿ä½œæˆ
5. `supabase/functions/invite-staff/index.ts` - name ã‚«ãƒ©ãƒ ä¿®æ­£ã€invitation_logså‰Šé™¤
6. `supabase/functions/get-report/index.ts` - generated_at â†’ created_atä¿®æ­£

### æœ€çµ‚çµè«–
- **è¨­è¨ˆæ›¸æ•´åˆæ€§**: âœ… é‡å¤§ãªæ¼ã‚Œãªã—
- **Edge Functionæ•´åˆæ€§**: âœ… 6ã¤ã®Edge Functionã‚¹ã‚­ãƒ¼ãƒä¿®æ­£å®Œäº†
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: âœ… 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆ
- **æ©Ÿèƒ½å®Ÿè£…ç‡**: 97% (Phase 1/2å®Œäº†)

**16å‘¨ã®æ¤œè¨¼ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚å…¨Edge FunctionsãŒDBã‚¹ã‚­ãƒ¼ãƒã¨æ•´åˆã—ã¦ã„ã¾ã™ã€‚**

---

## 17å‘¨ç›®ç¢ºèªçµæœ (2025-12-04)

### analyze-segment/index.ts è¿½åŠ ä¿®æ­£

#### ğŸ”´ ç™ºè¦‹ã•ã‚ŒãŸå•é¡Œ

**å•é¡Œç‚¹**:
- `transcripts` ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ `start_time`, `end_time` ã‚«ãƒ©ãƒ ï¼ˆç§’ã€NUMERICå‹ï¼‰ã‚’ä½¿ç”¨
- ã—ã‹ã— `analyze-segment` ã¯ `start_time_ms`, `end_time_ms` ã‚’æƒ³å®šã—ã¦ã„ãŸ
- ã‚¯ã‚¨ãƒª: `.order('start_time_ms'...)` â†’ ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
- mergeSegmentsé–¢æ•°: `transcript.start_time_ms` ã‚’å‚ç…§ â†’ undefined

**ä¿®æ­£å†…å®¹**:
1. TranscriptSegmentã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä¿®æ­£:
```typescript
// Before (èª¤)
start_time_ms: number;
end_time_ms: number;

// After (æ­£)
start_time: number;  // seconds (NUMERIC from DB)
end_time: number;    // seconds (NUMERIC from DB)
```

2. ã‚¯ã‚¨ãƒªã®orderå¥ã‚’ä¿®æ­£:
```typescript
// Before (èª¤)
.order('start_time_ms', { ascending: true });

// After (æ­£)
.order('start_time', { ascending: true });
```

3. mergeSegmentsé–¢æ•°ã§ç§’â†’ãƒŸãƒªç§’å¤‰æ›ã‚’è¿½åŠ :
```typescript
// Convert transcript time from seconds to milliseconds for comparison
const transcriptStartMs = Math.round(Number(transcript.start_time) * 1000);
const transcriptEndMs = Math.round(Number(transcript.end_time) * 1000);
```

#### âœ… ç¢ºèªæ¸ˆã¿Edge Functionsï¼ˆ17å‘¨ç›®ï¼‰
- `end-session/index.ts` - å•é¡Œãªã—
- `create-session/index.ts` - å•é¡Œãªã—
- `start-roleplay/index.ts` - å•é¡Œãªã—
- `evaluate-roleplay/index.ts` - å•é¡Œãªã—
- `search-success-cases/index.ts` - å•é¡Œãªã—
- `register-push-token/index.ts` - å•é¡Œãªã—
- `roleplay-chat/index.ts` - å•é¡Œãªã—
- `send-notification/index.ts` - å•é¡Œãªã—

### 17å‘¨ç›®æ¤œè¨¼çµæœ: analyze-segmentã®transcriptsã‚«ãƒ©ãƒ æ•´åˆæ€§ä¿®æ­£ âœ…

---

## æœ€çµ‚æ¤œè¨¼å®Œäº†ã‚µãƒãƒªãƒ¼ï¼ˆ17å‘¨ç›®æ›´æ–°ï¼‰

### æ¤œè¨¼ãƒ©ã‚¦ãƒ³ãƒ‰çµæœä¸€è¦§
| å‘¨ | æ¤œè¨¼å†…å®¹ | çµæœ |
|----|---------|------|
| 1-7å‘¨ç›® | åˆæœŸæ¤œè¨¼ãƒ»æ©Ÿèƒ½å®Ÿè£…ç¢ºèª | å®Œäº† |
| 8å‘¨ç›® | DBã‚«ãƒ©ãƒ åæ•´åˆæ€§ | Salonå‹ä¿®æ­£ |
| 8å‘¨ç›® | çµåˆãƒ†ã‚¹ãƒˆä½œæˆ | 51ã‚·ãƒŠãƒªã‚ªä½œæˆ |
| 9å‘¨ç›® | è¨­è¨ˆæ›¸vså®Ÿè£…æ¯”è¼ƒ | 6ç‚¹ã®æ„å›³çš„å·®ç•°ç¢ºèª |
| 10å‘¨ç›® | ã‚¨ãƒ©ãƒ¼/å¤–éƒ¨é€£æº/ãƒ†ã‚¹ãƒˆ | å•é¡Œãªã— |
| 11å‘¨ç›® | ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ/çŠ¶æ…‹é·ç§» | å•é¡Œãªã— |
| 12å‘¨ç›® | ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ /ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | å•é¡Œãªã— |
| 13å‘¨ç›® | Edge Function vs DBã‚¹ã‚­ãƒ¼ãƒ | analyze-segment/generate-reportä¿®æ­£ |
| 14å‘¨ç›® | è¿½åŠ Edge Functionæ¤œè¨¼ | process-audio/diarization-callbackä¿®æ­£ |
| 15å‘¨ç›® | æ®‹ã‚ŠEdge Functionæ¤œè¨¼ | invite-staffä¿®æ­£ |
| 16å‘¨ç›® | å…¨Edge Functionæœ€çµ‚ç¢ºèª | get-reportä¿®æ­£ |
| **17å‘¨ç›®** | **transcriptsã‚«ãƒ©ãƒ åå†æ¤œè¨¼** | **analyze-segmentä¿®æ­£** |

### ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ13-17å‘¨ç›®ï¼‰
1. `supabase/functions/analyze-segment/index.ts` - session_analysesæ­£è¦åŒ–ã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œã€transcriptsã‚«ãƒ©ãƒ åä¿®æ­£
2. `supabase/functions/generate-report/index.ts` - èª­ã¿è¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£
3. `supabase/functions/process-audio/index.ts` - transcriptsã‚¹ã‚­ãƒ¼ãƒå¯¾å¿œ
4. `supabase/functions/diarization-callback/index.ts` - ç§’â†’ãƒŸãƒªç§’å¤‰æ›ã€speaker_segmentsã®ã¿ä½œæˆ
5. `supabase/functions/invite-staff/index.ts` - name ã‚«ãƒ©ãƒ ä¿®æ­£ã€invitation_logså‰Šé™¤
6. `supabase/functions/get-report/index.ts` - generated_at â†’ created_atä¿®æ­£

### DBã‚¹ã‚­ãƒ¼ãƒæ•´åˆæ€§ã¾ã¨ã‚

#### transcriptsãƒ†ãƒ¼ãƒ–ãƒ«
- `start_time`, `end_time`: **ç§’** (NUMERICå‹)
- `chunk_index`: ãƒãƒ£ãƒ³ã‚¯ç•ªå·
- `audio_url`: éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«URL

#### speaker_segmentsãƒ†ãƒ¼ãƒ–ãƒ«
- `start_time_ms`, `end_time_ms`: **ãƒŸãƒªç§’** (INTEGERå‹)
- `speaker`: 'stylist' | 'customer'
- `chunk_index`: ãƒãƒ£ãƒ³ã‚¯ç•ªå·

#### session_analysesãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆæ­£è¦åŒ–ã‚¹ã‚­ãƒ¼ãƒï¼‰
- `indicator_type`: 'talk_ratio' | 'question_analysis' | 'emotion_analysis' | ...
- `value`: æŒ‡æ¨™å€¤ (NUMERIC)
- `score`: ã‚¹ã‚³ã‚¢ (0-100)
- `details`: è©³ç´° (JSONB)

### æœ€çµ‚çµè«–
- **è¨­è¨ˆæ›¸æ•´åˆæ€§**: âœ… é‡å¤§ãªæ¼ã‚Œãªã—
- **Edge Functionæ•´åˆæ€§**: âœ… 7å›ã®ä¿®æ­£ã§å…¨ã¦DBã‚¹ã‚­ãƒ¼ãƒã¨æ•´åˆ
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: âœ… 51ã‚·ãƒŠãƒªã‚ªã®çµåˆãƒ†ã‚¹ãƒˆ
- **æ©Ÿèƒ½å®Ÿè£…ç‡**: 97% (Phase 1/2å®Œäº†)

**17å‘¨ã®æ¤œè¨¼ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚å…¨Edge FunctionsãŒDBã‚¹ã‚­ãƒ¼ãƒã¨æ•´åˆã—ã¦ã„ã¾ã™ã€‚**

---

*æœ€çµ‚æ›´æ–°: 2025-12-04 17å‘¨ç›®å®Œäº†ï¼ˆtranscriptsã‚«ãƒ©ãƒ åä¿®æ­£å®Œäº†ï¼‰*
