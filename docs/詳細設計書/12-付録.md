## 12. ä»˜éŒ²

### 12.1 ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

> **ğŸ”´ é‡è¦ï¼ˆ2025-12-05 æ±ºå®šï¼‰: å…¨ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ snake_case çµ±ä¸€**
>
> ãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼ˆå‹ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ»APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼‰ã¯å…¨ã¦ **snake_case** ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
> è©³ç´°ã¯ CLAUDE.mdã€Œsnake_case çµ±ä¸€è¦å‰‡ã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#### 12.1.1 TypeScript

- **å‘½åè¦å‰‡**
  - ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ãƒ»é–¢æ•°: camelCase
  - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåãƒ»ã‚¯ãƒ©ã‚¹å: PascalCase
  - å®šæ•°: UPPER_SNAKE_CASE
  - ãƒ•ã‚¡ã‚¤ãƒ«å: kebab-caseï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯PascalCaseï¼‰
  - **ğŸ”´ ãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼ˆå‹ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: snake_case**

```typescript
// âœ… æ­£ã—ã„: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ snake_case
interface SessionData {
  session_id: string;
  started_at: string;
  customer_info: CustomerInfo;
}

// âŒ é–“é•ã„: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« camelCase ã¯ä½¿ç”¨ã—ãªã„
interface SessionData {
  sessionId: string;    // âŒ
  startedAt: string;    // âŒ
}
```

- **ã‚¤ãƒ³ãƒãƒ¼ãƒˆé †åº**
  1. React / React Native
  2. å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
  3. å†…éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆçµ¶å¯¾ãƒ‘ã‚¹ï¼‰
  4. ç›¸å¯¾ãƒ‘ã‚¹ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
  5. å‹ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

#### 12.1.2 SQL

- **å‘½åè¦å‰‡**
  - ãƒ†ãƒ¼ãƒ–ãƒ«å: snake_caseï¼ˆè¤‡æ•°å½¢ï¼‰
  - ã‚«ãƒ©ãƒ å: snake_case
  - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å: idx_{table}_{columns}
  - åˆ¶ç´„å: {table}_{constraint_type}_{description}

#### 12.1.3 å‹å®šç¾©ã®å˜ä¸€ã‚½ãƒ¼ã‚¹åŸå‰‡

**æ–¹é‡: Supabaseç”Ÿæˆå‹ã‚’å˜ä¸€ã‚½ãƒ¼ã‚¹ã¨ã—ã¦ä½¿ç”¨ï¼ˆsnake_caseçµ±ä¸€ï¼‰**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‹å®šç¾©ã®æµã‚Œ                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  DBã‚¹ã‚­ãƒ¼ãƒ (PostgreSQL)                                        â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼  supabase gen types typescript                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  apps/web/src/types/database.ts         â”‚  â† è‡ªå‹•ç”Ÿæˆ       â”‚
â”‚  â”‚  (snake_case)                           â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼  import                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Repository / Edge Functions / UI       â”‚  â† ãã®ã¾ã¾ä½¿ç”¨   â”‚
â”‚  â”‚  (snake_case)                           â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç†ç”±:**
1. **å‹å®‰å…¨æ€§**: DBã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€å¤‰æ›ãƒŸã‚¹ãŒãªã„
2. **ä¿å®ˆæ€§**: ã‚«ãƒ©ãƒ è¿½åŠ æ™‚ã«å‹å®šç¾©ã®æ‰‹å‹•æ›´æ–°ãŒä¸è¦
3. **ä¸€è²«æ€§**: å…¨ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§åŒã˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã‚’ä½¿ç”¨
4. **ã‚·ãƒ³ãƒ—ãƒ«**: å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ãŒä¸è¦

**ä½¿ç”¨æ–¹æ³•:**

```typescript
// å‹ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import type { Database } from '@/types/database';

// ãƒ†ãƒ¼ãƒ–ãƒ«å‹ã®å–å¾—
type SuccessCase = Database['public']['Tables']['success_cases']['Row'];
type SuccessCaseInsert = Database['public']['Tables']['success_cases']['Insert'];
type SuccessCaseUpdate = Database['public']['Tables']['success_cases']['Update'];

// ä½¿ç”¨ä¾‹
const successCase: SuccessCase = {
  id: 'uuid',
  salon_id: 'uuid',           // snake_case
  session_id: null,
  concern_keywords: [],       // snake_case
  approach_text: 'text',      // snake_case
  result: 'text',
  is_active: true,            // snake_case
  is_public: false,
  created_at: '2025-01-01',   // snake_case
  updated_at: '2025-01-01',
  // ...
};
```

**å‹ç”Ÿæˆã‚³ãƒãƒ³ãƒ‰:**

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«DBã‹ã‚‰å‹ç”Ÿæˆ
supabase gen types typescript --local > apps/web/src/types/database.ts

# ãƒªãƒ¢ãƒ¼ãƒˆDBã‹ã‚‰å‹ç”Ÿæˆ
supabase gen types typescript --project-id <project-id> > apps/web/src/types/database.ts
```

**å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã®ä½¿ç”¨:**

```typescript
// packages/shared/src/types/index.ts
export type { Database } from '../../../apps/web/src/types/database';

// ã‚¨ã‚¤ãƒªã‚¢ã‚¹å®šç¾©ï¼ˆåˆ©ä¾¿æ€§å‘ä¸Šï¼‰
export type Tables = Database['public']['Tables'];
export type SuccessCase = Tables['success_cases']['Row'];
export type Session = Tables['sessions']['Row'];
export type Staff = Tables['staffs']['Row'];
// ...
```

**æ³¨æ„äº‹é …:**
- TypeScriptã‚³ãƒ¼ãƒ‰ã§ã¯ snake_case ã‚’è¨±å®¹ã™ã‚‹
- DBã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´æ™‚ã¯å¿…ãšå‹ã‚’å†ç”Ÿæˆã™ã‚‹
- æ‰‹å‹•ã§ã®å‹å®šç¾©è¿½åŠ ã¯åŸå‰‡ç¦æ­¢ï¼ˆRPCé–¢æ•°ã®æˆ»ã‚Šå€¤ç­‰ã¯ä¾‹å¤–ï¼‰

### 12.2 ç’°å¢ƒå¤‰æ•°ä¸€è¦§

| å¤‰æ•°å | èª¬æ˜ | å¿…é ˆ | ä¾‹ |
|--------|------|------|-----|
| SUPABASE_URL | Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆURL | â—‹ | https://xxx.supabase.co |
| SUPABASE_ANON_KEY | Supabase åŒ¿åã‚­ãƒ¼ | â—‹ | eyJ... |
| SUPABASE_SERVICE_ROLE_KEY | Supabase ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ãƒ¼ãƒ«ã‚­ãƒ¼ | â—‹ | eyJ... |
| ANTHROPIC_API_KEY | Claude API ã‚­ãƒ¼ | â—‹ | sk-ant-... |
| OPENAI_API_KEY | OpenAI API ã‚­ãƒ¼ | â—‹ | sk-... |
| PYANNOTE_SERVER_URL | pyannote ã‚µãƒ¼ãƒãƒ¼URL | â—‹ | http://... |
| PYANNOTE_API_KEY | pyannote API ã‚­ãƒ¼ | â—‹ | ... |
| PYANNOTE_CALLBACK_SECRET | Callbackèªè¨¼ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ | â—‹ | ... |

### 12.3 ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸€è¦§

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆReact Native / Next.jsï¼‰

| ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|-----------|-----------|------|
| react | 18.x | UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| react-native | 0.73.x | ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª |
| expo | ~50.x | React Nativeé–‹ç™ºç’°å¢ƒ |
| next | 14.x | Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| @supabase/supabase-js | 2.x | Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ |
| zustand | 4.x | çŠ¶æ…‹ç®¡ç† |
| swr | 2.x | ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚° |
| zod | 3.x | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| recharts | 2.x | ã‚°ãƒ©ãƒ•æç”» |

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆEdge Functionsï¼‰

| ãƒ©ã‚¤ãƒ–ãƒ©ãƒª | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|-----------|-----------|------|
| @anthropic-ai/sdk | 0.x | Claude API |
| deno std | 0.177+ | Denoæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |

---
